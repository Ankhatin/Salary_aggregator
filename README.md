# **Дипломный проект по курсу "Python-разработчик" образовательной платформы Skypro**

Представляю дипломный проект.

Название проекта: Алгоритм агрегации статистических данных о зарплатах сотрудников.

Описание задачи: разработать алгоритм агрегации статистических данных о зарплатах сотрудников компании по временным промежуткам.

Используемая база данных: документоориентированная база данных MongoDB.

Исходные данные представлены в формате BSON (binary JSON). Для загрузки в базу данных MongoDB используется утилита mongostore MongoDB Database Tools.

Фреймворк для реализации API: FastAPI.

Критические зависимости (библиотеки) проекта:
1. fastapi - реализация API
2. motor - драйвер для асинхронной работы с MongoDB
3. aiogram - для асинхронной работы Телеграм-бота

Алгоритм принимает на вход:
- Дату и время старта агрегации в ISO формате (далее `dt_from`)
- Дату и время окончания агрегации в ISO формате (далее `dt_upto`)
- Тип агрегации (далее `group_type`): hour, day, month (группировка данных за час, день, месяц).

Алгоритм формирует на выходе:
- Агрегированный массив данных (`dataset`)
- Подписи к значениям агрегированного массива данных в ISO формате (`labels`)

API проекта принимает HTTP-запросы по следующим маршрутам:
- `http://0.0.0.0:8000/`
- `http://0.0.0.0:8000/aggregated_data/`

Первый путь возвращает ответ в виде html документа с ознакомительной информацией по работе сервиса.

Второй путь использует GET и POST операции. Первый метод принимает параметры запроса через адресную строку браузера (url). Пример:
`http://127.0.0.1:8000/aggregated_data/?dt_from=2022-10-01T00:00:00&dt_upto=2022-11-30T23:59:00&group_type=day`.

Метод POST принимает параметры запроса через тело запроса (body) в виде json строки.
Оба метода возвращают ответ JSONResponse.

Взаимодействие с базой данных MongoDB реализовано посредством драйвера motor для асинхронной работы. Асинхронный режим позволяет оптимально
задействовать вычислительные ресурсы сервера и обеспечивать конкуретное выполнение задачи при большой загрузке.

Дополнительный (дублирующий) функционал сервиса реализован посредством Телеграм-бота.
Телеграм-бот стартует при запуске приложения и в реальном времени принимает запросы и возвращает ответы.
Формат запросов и ответов: json. Телеграм-бот запущен в асинхронном режиме, что обеспечивает конкуретное выполнение задач пользователей
при большом количестве запросов/ответов.

Команда для запуска сервера: `uvicorn app:app`

Альтернативный вариант для запуска в режиме разработки: `fastapi dev app.py`.

В режиме продакшн: `fastapi run app.py`



